/*!
 * angular-translate - v2.1.0 - 2014-04-02
 * http://github.com/PascalPrecht/angular-translate
 * Copyright (c) 2014 ; Licensed MIT
 */
angular.module("pascalprecht.translate").provider("$translatePartialLoader",function(){function e(e){this.name=e;this.isActive=true;this.tables={}}function n(e){return t.hasOwnProperty(e)}function r(e){return angular.isString(e)&&e!==""}function i(e){if(!r(e)){throw new TypeError("Invalid type of a first argument, a non-empty string expected.")}return n(e)&&t[e].isActive}function s(e,t){for(var n in t){if(t[n]&&t[n].constructor&&t[n].constructor===Object){e[n]=e[n]||{};arguments.callee(e[n],t[n])}else{e[n]=t[n]}}return e}e.prototype.parseUrl=function(e,t){return e.replace(/\{part\}/g,this.name).replace(/\{lang\}/g,t)};e.prototype.getTable=function(e,t,n,r,i){var s=t.defer();if(!this.tables[e]){var o=this;n({method:r.indexOf("callback=")>-1?"JSONP":"GET",url:this.parseUrl(r,e)}).success(function(t){o.tables[e]=t;s.resolve(t)}).error(function(){if(i){i(o.name,e).then(function(t){o.tables[e]=t;s.resolve(t)},function(){s.reject(o.name)})}else{s.reject(o.name)}})}else{s.resolve(this.tables[e])}return s.promise};var t={};this.addPart=function(i){if(!r(i)){throw new TypeError("Couldn't add part, part name has to be a string!")}if(!n(i)){t[i]=new e(i)}t[i].isActive=true;return this};this.setPart=function(i,s,o){if(!r(i)){throw new TypeError("Couldn't set part.`lang` parameter has to be a string!")}if(!r(s)){throw new TypeError("Couldn't set part.`part` parameter has to be a string!")}if(typeof o!=="object"||o===null){throw new TypeError("Couldn't set part. `table` parameter has to be an object!")}if(!n(s)){t[s]=new e(s);t[s].isActive=false}t[s].tables[i]=o;return this};this.deletePart=function(e){if(!r(e)){throw new TypeError("Couldn't delete part, first arg has to be string.")}if(n(e)){t[e].isActive=false}return this};this.isPartAvailable=i;this.$get=["$rootScope","$injector","$q","$http",function(o,u,a,f){var l=function(e){function h(e){l.push(e)}if(!r(e.key)){throw new TypeError("Unable to load data, a key is not a non-empty string.")}if(!r(e.urlTemplate)){throw new TypeError("Unable to load data, a urlTemplate is not a non-empty string.")}var i=e.loadFailureHandler;if(i!==undefined){if(!angular.isString(i)){throw new Error("Unable to load data, a loadFailureHandler is not a string.")}else i=u.get(i)}var o=[],l=[],c=a.defer();for(var p in t){if(n(p)&&t[p].isActive){o.push(t[p].getTable(e.key,a,f,e.urlTemplate,i).then(h))}}if(o.length){a.all(o).then(function(){var e={};for(var t=0;t<l.length;t++){s(e,l[t])}c.resolve(e)},function(){c.reject(e.key)})}else{c.resolve({})}return c.promise};l.addPart=function(i){if(!r(i)){throw new TypeError("Couldn't add part, first arg has to be a string")}if(!n(i)){t[i]=new e(i);o.$emit("$translatePartialLoaderStructureChanged",i)}else if(!t[i].isActive){t[i].isActive=true;o.$emit("$translatePartialLoaderStructureChanged",i)}return l};l.deletePart=function(e,i){if(!r(e)){throw new TypeError("Couldn't delete part, first arg has to be string")}if(i===undefined){i=false}else if(typeof i!=="boolean"){throw new TypeError("Invalid type of a second argument, a boolean expected.")}if(n(e)){var s=t[e].isActive;if(i){delete t[e]}else{t[e].isActive=false}if(s){o.$emit("$translatePartialLoaderStructureChanged",e)}}return l};l.isPartAvailable=i;return l}]})